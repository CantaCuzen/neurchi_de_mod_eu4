namespace = streltsy_events

#Streltsy Protests
country_event = {
	id = streltsy_events.1
	title = streltsy_events.1.t
	desc = streltsy_events.1.d
	picture = STRELTSY_MARCHING_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		OR = {
			AND = {
				government_rank = 1
				num_of_streltsy = 15
			}
			AND = {
				government_rank = 3
				num_of_streltsy = 25
			}
		}
		is_in_war = {
			duration = 730
		}
		NOT = { has_country_modifier = streltsy_concessions }
		NOT = { has_country_modifier = streltsy_angered }
		NOT = { has_country_modifier = streltsy_revolted }
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				save_event_target_as = streltsy_revolt
			}
		}
	}

	mean_time_to_happen = {
		days = 1
		modifier = {
			factor = 2
			war_exhaustion = 5
		}
		modifier = {
			factor = 2
			war_exhaustion = 10
		}
		modifier = {
			factor = 2
			war_exhaustion = 15
		}
		modifier = {
			factor = 4
			war_exhaustion = 20
		}
		modifier = {
			factor = 0.5
			has_country_modifier = streltsy_inspection
		}
	}

	option = {
		name = streltsy_events.1.a #
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				num_of_cities = 30
				army_size_percentage = 0.8
			}
		}
		add_country_modifier = {
			name = "streltsy_concessions"
			duration = 10950
		}
	}
	option = {
		name = streltsy_events.1.b #
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0
				NOT = { army_size_percentage = 0.6 }
			}
		}
		custom_tooltip = streltsy_events.1.b.tt
		if = {
			limit = {
				has_government_mechanic = russian_mechanic
			}
			add_government_power = {
				government_mechanic = russian_mechanic
				which = MIL
				amount = -15
			}
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = { war_exhaustion = 2 }
				}
				random_list = {
					75 = { }
					25 = { country_event = { id = streltsy_events.2 } }
				}
			}
			if = {
				limit = {
					war_exhaustion = 2
					NOT = { war_exhaustion = 8 }
				}
				random_list = {
					65 = { }
					35 = { country_event = { id = streltsy_events.2 } }
				}
			}
			if = {
				limit = {
					war_exhaustion = 8
					NOT = { war_exhaustion = 12 }
				}
				random_list = {
					50 = { }
					50 = { country_event = { id = streltsy_events.2 } }
				}
			}
			if = {
				limit = {
					war_exhaustion = 12
				}
				random_list = {
					25 = { }
					75 = { country_event = { id = streltsy_events.2 } }
				}
			}
		}
		add_country_modifier = {
			name = "streltsy_angered"
			duration = 10950
		}
	}
	option = {
		name = streltsy_events.1.c #
		ai_chance = {
			factor = 0
		}
		custom_tooltip = streltsy_events.1.c.tt
		if = {
			limit = {
				has_government_mechanic = russian_mechanic
			}
			add_government_power = {
				government_mechanic = russian_mechanic
				which = MIL
				amount = -15
			}
		}
		hidden_effect = {
			country_event = { id = streltsy_events.2 }
		}
	}
}

#Streltsy Revolt
country_event = {
	id = streltsy_events.2
	title = streltsy_events.2.t
	desc = streltsy_events.2.d
	picture = STRELTSY_MARCHING_eventPicture

	is_triggered_only = yes

	option = {
		name = streltsy_events.2.a #
		trigger = { government = monarchy }
		remove_country_modifier = streltsy_angered
		add_country_modifier = {
			name = "streltsy_revolted"
			duration = 10950
		}
		if = {
			limit = {
				NOT = { num_of_streltsy = 20 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 20
				NOT = { num_of_streltsy = 45 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 30
				NOT = { num_of_streltsy = 45 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 45
				NOT = { num_of_streltsy = 60 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 60
				NOT = { num_of_streltsy = 75 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 75
				NOT = { num_of_streltsy = 90 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 90
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 2
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = pretender_rebels
						size = 1
					}
				}
			}
		}
	}
	option = {
		name = streltsy_events.2.a #
		trigger = {
			NOT = { government = monarchy }
		}
		remove_country_modifier = streltsy_angered
		add_country_modifier = {
			name = "streltsy_revolted"
			duration = 10950
		}
		if = {
			limit = {
				NOT = { num_of_streltsy = 30 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 30
				NOT = { num_of_streltsy = 45 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 45
				NOT = { num_of_streltsy = 60 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 60
				NOT = { num_of_streltsy = 75 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 75
				NOT = { num_of_streltsy = 90 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = anti_tax_rebels
					size = 1
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 90
				NOT = { num_of_streltsy = 105 }
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = anti_tax_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
		}
		if = {
			limit = {
				num_of_streltsy = 105
			}
			event_target:streltsy_revolt = {
				spawn_rebels = {
					type = anti_tax_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 2
					}
				}
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					is_capital = no
				}
				spawn_rebels = {
					type = anti_tax_rebels
					size = 2
				}
				random_neighbor_province = {
					limit = {
						owned_by = ROOT
						is_capital = no
					}
					spawn_rebels = {
						type = anti_tax_rebels
						size = 1
					}
				}
			}
		}
	}
}
